# ~/.zshrc

# homebrew
[[ -f "/opt/homebrew/bin/brew" ]] && eval "$(/opt/homebrew/bin/brew shellenv)"

# starship prompt
eval "$(starship init zsh)"

# zsh plugins
source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
source /opt/homebrew/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source /opt/homebrew/share/zsh-history-substring-search/zsh-history-substring-search.zsh

# enable completion system
autoload -Uz compinit
compinit

# completion styles
zstyle ':completion:*' menu select
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Za-z}'

# git completion for aliases
compdef g=git

# environment variables
typeset -U PATH path
export VISUAL="nvim"
export EDITOR="nvim"
export GPG_TTY=$(tty)
export OLLAMA_HOST=http://0.0.0.0:11434

# path modifications
export LOCAL_BIN="${HOME}/.local/bin"
[[ -d "$LOCAL_BIN" ]] && path+=("$LOCAL_BIN")

# asdf version manager
source /opt/homebrew/opt/asdf/libexec/asdf.sh

export PNPM_HOME="${HOME}/Library/pnpm"
[[ -d "$PNPM_HOME" ]] && path+=("$PNPM_HOME")

# libpq (PostgreSQL client tools)
[[ -d "/opt/homebrew/opt/libpq/bin" ]] && path+=("/opt/homebrew/opt/libpq/bin")

# java/android environment
if [[ -d "/Library/Java/JavaVirtualMachines/zulu-17.jdk/Contents/Home" ]]; then
  export JAVA_HOME="/Library/Java/JavaVirtualMachines/zulu-17.jdk/Contents/Home"
fi
if [[ -d "$HOME/Library/Android/sdk" ]]; then
  export ANDROID_HOME="$HOME/Library/Android/sdk"
fi
[[ -d "$ANDROID_HOME/emulator" ]] && path+=("$ANDROID_HOME/emulator" "$ANDROID_HOME/platform-tools")

# zoxide (modern directory jumper)
eval "$(zoxide init zsh)"

# zsh options
setopt NO_EXTENDED_GLOB
setopt SHARE_HISTORY
setopt HIST_IGNORE_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_VERIFY
setopt HIST_REDUCE_BLANKS
setopt AUTO_CD
setopt AUTO_PUSHD
setopt PUSHD_IGNORE_DUPS
setopt PUSHD_MINUS
setopt PUSHD_SILENT
setopt AUTO_MENU
setopt AUTO_PARAM_SLASH
setopt COMPLETE_IN_WORD
setopt MENU_COMPLETE
setopt AUTO_CONTINUE
setopt CHECK_JOBS
setopt LONG_LIST_JOBS

# history
HISTFILE=${HOME}/.zsh_history
HISTSIZE=10000
SAVEHIST=10000

# tool configurations
export FZF_DEFAULT_OPTS='--height 40% --layout=reverse --border'
ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=240'

# key bindings
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down
bindkey '^ ' autosuggest-accept
bindkey '^A' beginning-of-line
bindkey '^E' end-of-line
bindkey '^K' kill-line
bindkey '^U' backward-kill-line

# aliases
alias g='git'
alias ga='git add'
alias gap='git add -p'
alias gb='git branch'
alias gc='git commit'
alias gcm='git commit -m'
alias gd='git diff'
alias gdc='git diff --cached'
alias gdw='git diff --word-diff'
alias gl='git l'
alias gla='git la'
alias gpush='git push'
alias gs='git status -sb'
alias gshow='git show'
alias gclaude='git claude'

alias vim='nvim'
alias code="cursor"
alias c="code"
alias cat="bat --style=plain --paging=never"
alias less="bat --style=plain"
alias f='fzf'

# asdf i type too fast
alias adsf="asdf"

alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias ls='eza'
alias ll='eza -la'
alias la='eza -A'
alias l='eza -F'
alias mkdir='mkdir -p'
alias df='df -h'
alias du='du -h'

# local overrides
[[ -f ~/.zshrc.local ]] && source ~/.zshrc.local

# opencode
export PATH=/Users/matt/.opencode/bin:$PATH
eval "$(~/.local/bin/mise activate)"
